webpackJsonp([1],{A7W3:function(e,s){},HTBJ:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={props:{user:{name:String,phone:String,subordinates:Array},level:Number},data:function(){return{isShowSubordinates:!1}},components:{User:function(){return new Promise(function(e){e()}).then(t.bind(null,"HTBJ"))}},computed:{levelMargin:function(){return 10*this.level+"px"}}},n={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"row-wrapper"},[t("div",{staticClass:"table-row"},[t("div",{staticClass:"user-name-wrapper"},[t("span",{staticClass:"expand-button",style:{marginLeft:e.levelMargin},on:{click:function(s){e.isShowSubordinates=!e.isShowSubordinates}}},[e._v("\n                "+e._s(e.user.subordinates.length?e.isShowSubordinates?"-":"+":"")+"\n            ")]),e._v(" "),t("span",{staticClass:"user-name"},[e._v(e._s(e.user.name))])]),e._v(" "),t("div",{staticClass:"user-phone-wrapper"},[t("span",{staticClass:"user-phone"},[e._v(e._s(e.user.phone))])])]),e._v(" "),e.isShowSubordinates?t("div",{staticClass:"inner"},e._l(e.user.subordinates,function(s){return t("User",{key:s.id,attrs:{user:s,level:e.level+1}})}),1):e._e()])},staticRenderFns:[]};var a=t("VU/8")(r,n,!1,function(e){t("OoQ8")},null,null);s.default=a.exports},NHnr:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r=t("7+uW"),n=t("fZjL"),a=t.n(n),o={components:{UserRow:t("HTBJ").default},props:["columns","users"],data:function(){return{orders:{}}},methods:{resetOtherOrders:function(e){var s=this;a()(this.orders).forEach(function(t){return s.orders[t]=t===e?s.orders[t]:null})},sortByKey:function(e){this.resetOtherOrders(e),this.orders[e]?this.orders[e]*=-1:this.orders[e]=1,this.sortUsers(this.users,e,this.orders[e])},sortUsers:function(e,s,t){var r=this;1===e.length&&e[0].subordinates&&this.sortUsers(e[0].subordinates,s,t),e.sort(function(e,n){return e.subordinates&&r.sortUsers(e.subordinates,s,t),n.subordinates&&r.sortUsers(n.subordinates,s,t),e[s].localeCompare(n[s])*t})}}},i={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"table"},[t("div",{staticClass:"header"},e._l(e.columns,function(s){return t("div",{key:s.key,staticClass:"column",on:{click:function(t){return e.sortByKey(s.key)}}},[e.orders[s.key]?t("i",[e._v(e._s(e.orders[s.key]>0?"▲":"▼"))]):e._e(),e._v("\n            "+e._s(s.name)+"\n        ")])}),0),e._v(" "),e._l(e.users,function(e){return t("UserRow",{key:e.id,attrs:{user:e,level:0}})})],2)},staticRenderFns:[]};var u=t("VU/8")(o,i,!1,function(e){t("PUCV")},null,null).exports,l=t("Gu7T"),c=t.n(l),d=t("mvHQ"),p=t.n(d),v={props:{users:Array},data:function(){return{allUsers:[],form:{name:"",phone:"",superiorId:null,id:Math.random().toString(36).substring(2,9)}}},methods:{handleClose:function(){this.$emit("close")},addUser:function(){var e=this.form,s=e.name,t=e.phone,r=e.id,n=e.superiorId,a={name:s,phone:t,id:r,subordinates:[]};if(n){var o=this.allUsers.find(function(e){return e.id===n});o&&o.subordinates.push(a)}else this.users.push(a);localStorage.setItem("users",p()(this.users))},handleSubmit:function(){this.addUser(),this.handleClose()},flatUsers:function(e){var s=this;return e.reduce(function(e,t){return e.concat(t.subordinates?[t].concat(c()(s.flatUsers(t.subordinates))):t)},[])}},mounted:function(){this.allUsers=this.flatUsers(this.users)}},m={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"modal-mask",on:{click:function(s){return s.target!==s.currentTarget?null:e.handleClose.apply(null,arguments)}}},[t("div",{staticClass:"modal-wrapper"},[t("div",{staticClass:"modal-container"},[t("form",{on:{submit:function(s){return s.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[t("div",{staticClass:"header-wrapper"},[t("span",{staticClass:"header"},[e._v("Добавление пользователя")]),e._v(" "),t("button",{staticClass:"close-button",attrs:{type:"button"},on:{click:e.handleClose}},[e._v("X")])]),e._v(" "),t("div",{staticClass:"form-wrapper"},[t("div",{staticClass:"field-wrapper"},[t("label",{attrs:{for:"name"}},[e._v("Имя")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],attrs:{placeholder:"Введите имя пользователя",required:"",id:"name",type:"text"},domProps:{value:e.form.name},on:{input:function(s){s.target.composing||e.$set(e.form,"name",s.target.value)}}})]),e._v(" "),t("div",{staticClass:"field-wrapper"},[t("label",{attrs:{for:"phone"}},[e._v("Телефон")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.phone,expression:"form.phone"}],attrs:{placeholder:"Введите номер телефона",id:"phone",required:"",type:"tel",maxlength:"13"},domProps:{value:e.form.phone},on:{input:function(s){s.target.composing||e.$set(e.form,"phone",s.target.value)}}})]),e._v(" "),t("div",{staticClass:"field-wrapper"},[t("label",{attrs:{for:"superior"}},[e._v("Начальник")]),e._v(" "),t("select",{attrs:{name:"superior",id:"superior"},on:{change:function(s){e.form.superiorId=s.target.value}}},[t("option",{attrs:{value:"#"}}),e._v(" "),e._l(e.allUsers,function(s){return t("option",{key:s.id,domProps:{value:s.id}},[e._v("\n                                "+e._s(s.name)+"\n                            ")])})],2)])]),e._v(" "),e._m(0)])])])])},staticRenderFns:[function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"actions-wrapper"},[s("button",{staticClass:"add-button",attrs:{type:"submit"}},[this._v("Сохранить")])])}]};var f={name:"App",components:{UserTable:u,AddUserModal:t("VU/8")(v,m,!1,function(e){t("O9DO")},"data-v-594350bf",null).exports},data:function(){return{showModal:!1,users:[],columns:[{name:"Имя",key:"name"},{name:"Телефон",key:"phone"}]}},mounted:function(){try{this.users=JSON.parse(localStorage.getItem("users")||"[]")}catch(e){this.clearUsers()}},methods:{clearUsers:function(){this.users=[],localStorage.removeItem("users")}}},h={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"container",attrs:{id:"app"}},[t("div",{staticClass:"button-wrapper"},[t("button",{staticClass:"button",on:{click:e.clearUsers}},[e._v("Отчистить")]),e._v(" "),t("button",{staticClass:"button",on:{click:function(s){e.showModal=!e.showModal}}},[e._v("Добавить")])]),e._v(" "),e.showModal?t("AddUserModal",{attrs:{users:e.users},on:{close:function(s){e.showModal=!1}}}):e._e(),e._v(" "),t("UserTable",{attrs:{users:e.users,columns:e.columns}})],1)},staticRenderFns:[]};var _=t("VU/8")(f,h,!1,function(e){t("A7W3")},null,null).exports;r.a.config.productionTip=!1,new r.a({el:"#app",components:{App:_},template:"<App/>"})},O9DO:function(e,s){},OoQ8:function(e,s){},PUCV:function(e,s){}},["NHnr"]);
//# sourceMappingURL=app.66c36dc4ce9b9f2560cd.js.map